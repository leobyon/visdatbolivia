getwd()
df.Pob.Pais <- read.csv("./pobreza_paises.csv", stringsAsFactors = F) %>%
filter(grepl("bolivia|korea|united states", tolower(CountryName))) %>%
select(CountryName,
RequestYear,
HeadCount,
ReqYearPopulation) %>%
dplyr::rename(Region = CountryName,
A침o = RequestYear,
Proporcion = HeadCount,
Poblacion = ReqYearPopulation) %>%
mutate(Region = ifelse(grepl("korea", tolower(Region)), "Corea del Sur",
ifelse(grepl("united", tolower(Region)), "EEUU", "Bolivia")))
library(dplyr)
library(ggplot2)
library(reshape2)
library(ggrepel)
opts <- function(base_size = 12, base_family = "sans"){
theme_minimal(base_size = base_size, base_family = base_family) +
theme(
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
panel.grid.major = element_line(color = "grey"),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "aliceblue"),
strip.background = element_rect(fill = "darkgrey", color = "grey", size = 1),
strip.text = element_text(face = "bold", size = 12, color = "white"),
legend.position = "right",
legend.justification = "top",
panel.border = element_rect(color = "grey", fill = NA, size = 0.5)
)
}
df.Pob.Pais <- read.csv("./pobreza_paises.csv", stringsAsFactors = F) %>%
filter(grepl("bolivia|korea|united states", tolower(CountryName))) %>%
select(CountryName,
RequestYear,
HeadCount,
ReqYearPopulation) %>%
dplyr::rename(Region = CountryName,
A침o = RequestYear,
Proporcion = HeadCount,
Poblacion = ReqYearPopulation) %>%
mutate(Region = ifelse(grepl("korea", tolower(Region)), "Corea del Sur",
ifelse(grepl("united", tolower(Region)), "EEUU", "Bolivia")))
df.Pob.Region <- read.csv("./pobreza_regional.csv", stringsAsFactors = F) %>%
filter(grepl("latin america|world total", tolower(regionTitle))) %>%
select(regionTitle,
requestYear,
hc,
population) %>%
dplyr::rename(Region = regionTitle,
A침o = requestYear,
Proporcion = hc,
Poblacion = population) %>%
mutate(Region = ifelse(grepl("latin america", tolower(Region)), "LATAM", "Mundo"))
df.Pob <- rbind(df.Pob.Pais, df.Pob.Region) %>%
mutate(RegionTipo = ifelse(Region == "Bolivia", "Bolivia",
ifelse(Region %in% c("LATAM", "Mundo"), "Benchmark Regiones", "Benchmark Paises"))) %>%
mutate(Region = factor(Region, levels = unique(Region)),
RegionTipo = factor(RegionTipo, levels = c("Bolivia", "Benchmark Paises", "Benchmark Regiones")))
ggplot(df.Pob, aes(x = A침o,
y = round(Proporcion * 100,2),
color = Region))+
geom_label_repel(data = filter(df.Pob, A침o == max(A침o)) , aes(label = round(Proporcion * 100, 2)),
direction = "y", hjust = -1, show.legend = FALSE)+
geom_line(aes(linetype = RegionTipo), size = 1.5)+
scale_linetype_manual(values = c("solid", "dashed", "dotted"))+
scale_color_manual(values =  c("orangered", "royalblue", "yellowgreen", "firebrick","orange"))+
scale_x_continuous(breaks = seq(1980,2015, 5), limits = c(1980,2015))+
guides(linetype = FALSE)+
labs(x = "",
y = "Proporci칩n (%)",
title = "Proporci칩n de la Poblaci칩n Viviendo en Extrema Pobreza",
subtitle = "Extrema Pobreza se refiere a la poblaci칩n con ingresos de US$ 1.90/d칤a (2011 PPP)",
caption = "Fuente: PovcalNet, http://iresearch.worldbank.org/PovcalNet/home.aspx")+
opts()
library(dplyr)
library(ggplot2)
library(reshape2)
library(ggrepel)
##################
#extrema pobreza
##################
df.Pob.Pais <- read.csv("./pobreza_paises.csv", stringsAsFactors = F) %>%
filter(grepl("bolivia|korea|united states", tolower(CountryName))) %>%
select(CountryName,
RequestYear,
HeadCount,
ReqYearPopulation) %>%
dplyr::rename(Region = CountryName,
A츾췀o = RequestYear,
Proporcion = HeadCount,
Poblacion = ReqYearPopulation) %>%
mutate(Region = ifelse(grepl("korea", tolower(Region)), "Corea del Sur",
ifelse(grepl("united", tolower(Region)), "EEUU", "Bolivia")))
df.Pob.Region <- read.csv("./pobreza_regional.csv", stringsAsFactors = F) %>%
filter(grepl("latin america|world total", tolower(regionTitle))) %>%
select(regionTitle,
requestYear,
hc,
population) %>%
dplyr::rename(Region = regionTitle,
A츾췀o = requestYear,
Proporcion = hc,
Poblacion = population) %>%
mutate(Region = ifelse(grepl("latin america", tolower(Region)), "LATAM", "Mundo"))
df.Pob <- rbind(df.Pob.Pais, df.Pob.Region) %>%
mutate(RegionTipo = ifelse(Region == "Bolivia", "Bolivia",
ifelse(Region %in% c("LATAM", "Mundo"), "Benchmark Regiones", "Benchmark Paises"))) %>%
mutate(Region = factor(Region, levels = unique(Region)),
RegionTipo = factor(RegionTipo, levels = c("Bolivia", "Benchmark Paises", "Benchmark Regiones")))
ggplot(df.Pob, aes(x = A츾췀o,
y = round(Proporcion * 100,2),
color = Region))+
geom_label_repel(data = filter(df.Pob, A츾췀o == max(A츾췀o)) , aes(label = round(Proporcion * 100, 2)),
direction = "y", hjust = -1, show.legend = FALSE)+
geom_line(aes(linetype = RegionTipo), size = 1.5)+
scale_linetype_manual(values = c("solid", "dashed", "dotted"))+
scale_color_manual(values =  c("orangered", "royalblue", "yellowgreen", "firebrick","orange"))+
scale_x_continuous(breaks = seq(1980,2015, 5), limits = c(1980,2015))+
guides(linetype = FALSE)+
labs(x = "",
y = "Proporci츾췁n (%)",
title = "Proporci츾췁n de la Poblaci츾췁n Viviendo en Extrema Pobreza",
subtitle = "Extrema Pobreza se refiere a la poblaci츾췁n con ingresos de US$ 1.90/d츾셔 (2011 PPP)",
caption = "Fuente: PovcalNet, http://iresearch.worldbank.org/PovcalNet/home.aspx")+
opts()
